 <!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>DXN</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding-bottom: 80px; /* espacio para los resultados fijos */
      font-family: sans-serif;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      border: 2px solid black;
    }

    th, td {
      border: 2px solid black;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #00a608;
      color: white;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    img {
      width: 50px;
      height: auto;
    }

    #imagen-flotante {
      position: fixed;
      top: 400px;
      left: 20%;
      transform: translateX(-50%);
      background: white;
      border: 2px solid #333;
      padding: 10px;
      display: none;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      z-index: 999;
    }

    #imagen-flotante img {
      width: 200px;
      height: auto;
    }

    /* Resultados fijos abajo */
    #resultados-fijos {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: white;
      border-top: 2px solid black;
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr;
      font-weight: bold;
      text-align: center;
      padding: 5px 0;
      z-index: 100;
    }

    #resultados-fijos > div {
      border-right: 2px solid black;
      display: flex;
      flex-direction: column;
      justify-content: center;
      font-size: 16px;
    }

    #resultados-fijos > div:last-child {
      border-right: none;
    }

    #resultados-fijos .titulo {
      font-size: 12px;
      color: #444;
      margin-bottom: 3px;
    }
  </style>
</head>
<body>

  <table id="tabla">
    <thead>
      <tr>
        <th>IMAGEN</th>
        <th>PRODUCTOS</th>
        <th>PRECIO</th>
        <th>PV</th>
        <th>CANTIDAD</th>
        <th>TOTAL PV</th>
        <th>TOTAL</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><img src="https://i.postimg.cc/gJBhnQBJ/Screenshot-20250404-160558.jpg" alt="Producto"></td>
        <td>NON DAIRY CREAMER</td>
        <td class="precio">54</td>
        <td class="pv">1.5</td>
        <td contenteditable="true" class="unidad">0</td>
        <td class="total_pv">0</td>
        <td class="total">0</td>
      </tr>
    </tbody>
  </table>

  <!-- Resultados fijos abajo -->
  <div id="resultados-fijos">
    <div class="label">RESULTADOS:</div>
    <div>
      <div class="titulo">CANTIDAD</div>
      <div id="total_cantidad">0</div>
    </div>
    <div>
      <div class="titulo">PV</div>
      <div id="total_pv">0</div>
    </div>
    <div>
      <div class="titulo">TOTAL</div>
      <div id="total">0</div>
    </div>
  </div>

  <!-- Imagen flotante -->
  <div id="imagen-flotante"><img src="" alt="Producto S"></div>

  <script>
    function calcularTotal() {
      let filas = document.querySelectorAll("tbody tr");
      let totalPV = 0;
      let total = 0;
      let totalCantidad = 0;

      filas.forEach(fila => {
        let precio = parseFloat(fila.querySelector(".precio").innerText) || 0;
        let pv = parseFloat(fila.querySelector(".pv").innerText) || 0;
        let unidad = parseFloat(fila.querySelector(".unidad").innerText) || 0;

        let totalPVFila = unidad * pv;
        let totalFila = unidad * precio;

        fila.querySelector(".total_pv").innerText = totalPVFila.toFixed(2);
        fila.querySelector(".total").innerText = totalFila.toFixed();

        totalPV += totalPVFila;
        total += totalFila;
        totalCantidad += unidad;
      });

      document.getElementById("total_pv").innerText = totalPV.toFixed(2);
      document.getElementById("total").innerText = total.toFixed();
      document.getElementById("total_cantidad").innerText = totalCantidad.toFixed();
    }

    document.querySelectorAll(".unidad").forEach(td => {
      td.addEventListener("input", calcularTotal);

      td.addEventListener("click", function () {
        const fila = this.parentElement;
        const imagenSrc = fila.querySelector("td img").src;

        const flotante = document.getElementById("imagen-flotante");
        flotante.querySelector("img").src = imagenSrc;
        flotante.style.display = "block";

        setTimeout(() => {
          flotante.style.display = "none";
        }, 5000);
      });
    });

    calcularTotal();
  </script>

</body>
</html>
